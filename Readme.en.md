# Hexos



## Overview

Integration framework based on [hexo](https://hexo.io/zh-cn/)



## Component

### Plugin

* Excerpt of the article : [hexo-excerpt](https://github.com/chekun/hexo-excerpt)  Ver:  [1.1.6](https://www.npmjs.com/package/hexo-excerpt)
* Git Deployment : [hexo-deployer-git](https://github.com/hexojs/hexo-deployer-git)  Ver:  [2.1.0](https://www.npmjs.com/package/hexo-deployer-git)
* Feed : [hexo-generator-feed](https://github.com/hexojs/hexo-generator-feed)  Ver:  [3.0.0](https://www.npmjs.com/package/hexo-generator-feed) 
* Search data generation : [hexo-generator-search](https://github.com/wzpan/hexo-generator-search)  Ver:  [2.4.1](https://www.npmjs.com/package/hexo-generator-search)
* Search data generation : [hexo-generator-searchdb](https://github.com/theme-next/hexo-generator-searchdb)  Ver:  [1.3.3](https://www.npmjs.com/package/hexo-generator-searchdb)
* Site map : [hexo-generator-sitemap](https://github.com/hexojs/hexo-generator-sitemap)  Ver:  [2.1.0](https://www.npmjs.com/package/hexo-generator-sitemap)
* JSON content : [hexo-generator-json-content](https://github.com/alexbruno/hexo-generator-json-content)  Ver:  [4.2.3](https://www.npmjs.com/package/hexo-generator-json-content)
* Restful API : [hexo-generator-restful](https://github.com/yscoder/hexo-generator-restful)  Ver:  [0.2.3](https://www.npmjs.com/package/hexo-generator-restful)
  * PullRequests  is in progress, patches exist.
* External links nofollow : [hexo-filter-nofollow](https://github.com/hexojs/hexo-filter-nofollow)  Ver:   [2.0.2](https://www.npmjs.com/package/hexo-filter-nofollow) 
* Character statistics and reading time : [hexo-symbols-count-time](https://github.com/theme-next/hexo-symbols-count-time)  Ver:  [0.7.1](https://www.npmjs.com/package/hexo-symbols-count-time)
* Management interface of hexo : [hexo-admin](https://github.com/jaredly/hexo-admin)  Ver:  [2.3.0](https://www.npmjs.com/package/hexo-admin)
* Automatically generate categories : [hexo-auto-category](https://github.com/xu-song/hexo-auto-category)  Ver:  [0.2.0](https://www.npmjs.com/package/hexo-auto-category)
* Unique link : [hexo-abbrlink](https://github.com/rozbo/hexo-abbrlink)  Ver:  [2.2.1](https://www.npmjs.com/package/hexo-abbrlink)
* Video : [hexo-tag-owl](https://github.com/m80126colin/hexo-tag-owl)  Ver:  [1.2.2](https://www.npmjs.com/package/hexo-tag-owl)
* Blog top : [hexo-generator-topindex](https://github.com/amlove2/hexo-generator-topindex)  Ver:  [0.3.0](https://www.npmjs.com/package/hexo-generator-topindex)
* Code demo : [hexo-tag-demo](https://github.com/laomao800/hexo-tag-demo)  Ver:  [0.2.10](https://www.npmjs.com/package/hexo-tag-demo)
* **Content block**  : [hexo-admonition](https://github.com/lxl80/hexo-admonition)  Ver:  [1.1.2](https://www.npmjs.com/package/hexo-admonition)
  * It has been integrated.
* Information card : [hexo-valkyr-url](https://github.com/toastsgithub/hexo-valkyr-url)  Ver:  [1.1.0](https://www.npmjs.com/package/hexo-valkyr-url)
* Github Information card : [hexo-github-card](https://github.com/Gisonrg/hexo-github-card)  Ver:  [1.0.5](https://www.npmjs.com/package/hexo-github-card)
  * PullRequests  is in progress, patches exist.
* Bilibili page : [hexo-bilibili-bangumi](https://github.com/HCLonely/hexo-bilibili-bangumi)  Ver:  [1.5.1](https://www.npmjs.com/package/hexo-bilibili-bangumi)
* Tooltips : [hexo-reference](https://github.com/kchen0x/hexo-reference)  Ver:  [1.0.4](https://www.npmjs.com/package/hexo-reference)
* Flow chart: [hexo-filter-flowchart](https://github.com/bubkoo/hexo-filter-flowchart)  Ver:  [1.0.4](https://www.npmjs.com/package/hexo-filter-flowchart)
* UML，sequence : [hexo-filter-sequence](https://github.com/bubkoo/hexo-filter-sequence)  Ver:  [1.0.3](https://www.npmjs.com/package/hexo-filter-sequence)
* Rendering engine : [hexo-renderer-markdown-it](https://github.com/hexojs/hexo-renderer-markdown-it)  Ver:   [5.0.0](https://www.npmjs.com/package/hexo-renderer-markdown-it) 
  * PullRequests  is not passed, patch exists.
* Lazyload  image : [hexo-lazyload-image](https://github.com/Troy-Yang/hexo-lazyload-image)  Ver:  [1.0.9](https://www.npmjs.com/package/hexo-lazyload-image)
* Optimize HTML, CSS, JS and images: [hexo-all-minifier](https://github.com/chenzhutian/hexo-all-minifier)  Ver:  [0.5.5](https://www.npmjs.com/package/hexo-all-minifier)
* Push new links to search engines : [hexo-submit-urls-to-search-engine](https://github.com/cjh0613/hexo-submit-urls-to-search-engine)  Ver:   [2.0.0](https://www.npmjs.com/package/hexo-submit-urls-to-search-engine) 
* Qcode generation : [hexo-tag-qrcode](https://github.com/jsweibo/hexo-tag-qrcode)  Ver:  [1.0.0](https://www.npmjs.com/package/hexo-tag-qrcode)
* Audio : [hexo-tag-aplayer](https://github.com/MoePlayer/hexo-tag-aplayer)  Ver:  [3.0.4](https://www.npmjs.com/package/hexo-tag-aplayer)
* Related and popular posts  : [hexo-related-popular-posts](https://github.com/tea3/hexo-related-popular-posts)  Ver:  [5.0.1](https://www.npmjs.com/package/hexo-related-popular-posts)



### Theme

* NexT： [theme-next/hexo-theme-next](https://github.com/theme-next/hexo-theme-next)    v7.8.0 :  [`f995680`](https://github.com/theme-next/hexo-theme-next/commit/f9956802c9cf51ebdb447fb954efa6383fbb2bd6) 



## Use

### Download

```shell
git clone --depth 1 https://github.com/StaticSiteTools/Hexos  Hexos
```



### Install

```
./Start  install
```



### Patch

```
./Start  patch
```



### Initialization

```
./Start  init  [Lang]  [Theme] [Author]
```

`[Lang]` :  Language(en|cn\<default>)

`[Theme]` :  Theme(next\<default>|) 

`[Author]` :  Author

> **Note**: initialization only needs to be performed once.



### Online integration

The online integration services used are:

* [Travis CI](https://travis-ci.com/)
* [Github Actions](https://docs.github.com/en/free-pro-team@latest/actions)

#### Travis CI

You need to configure the following environment variables in the Travis CI web page:

* `HEXOS_GITHUB_TOKEN`:  Github token。

* `HEXOS_GITEE_USER`:  Gitee user。
  * Personal space address suffix, such as `XXX` in `https://gitee.com/XXX`.

* `HEXOS_GITEE_TOKEN`:  Gitee token。

* `HEXOS_CODING_PROJECT_USER`:  Coding project user。

* `HEXOS_CODING_PROJECT_TOKEN`:  Coding project token。

* `HEXOS_U_NAME`:  Committer。

* `HEXOS_U_EMAIL`:  Committer’s mail。

* `HEXOS_GITHUB_REF`:  Repository url，[Github](https://github.com/)。no with  `https`。

* `HEXOS_GITHUB_BRANCH`:  Remote branch，[Github](https://github.com/)。

* `HEXOS_GITEE_REF`:  Repository url，[Gitee](https://gitee.com/)。no with `https`。

* `HEXOS_GITEE_BRANCH`: Remote branch，[Gitee](https://gitee.com/)。

* `HEXOS_CODING_REF`:  Repository url，[Coding](https://coding.net/)。no with `https`。

* `HEXOS_CODING_BRANCH`: Remote branch，[Coding](https://coding.net/)。

* `HEXOS_NOTICE_EMAIL`:  Email address to receive notification. Required.

* `TZ`:  Time zone.  See  [Timezones](https://www.php.net/manual/en/timezones.php)。**Required**。

* ~~`HEXOS_WATCH_BRANCH` :  Monitor the branches in the project source. Required.~~

  * After actual operation, it seems that variables cannot be used in `branches` sections. Please modify it directly in  `.travis.yml` .

    ```yaml
    branches:
      only:
        - master
    ```

    

By default, only the GitHub platform is enabled. To push to other code hosting platforms, you need to modify in  `.travis.yml`  and remove the previous `#`.

```yaml
  #------------START: Push to remote repository ------------#  
  # Github 
  - git push --force --quiet "https://${HEXOS_GITHUB_TOKEN}@${HEXOS_GITHUB_REF}" master:${HEXOS_GITHUB_BRANCH}
  
  # Gitee
  - git push --force --quiet "https://${HEXOS_GITEE_USER}:${HEXOS_GITEE_TOKEN}@${HEXOS_GITEE_REF}" master:${HEXOS_GITEE_BRANCH}
  
  # Coding
  - git push --force --quiet "https://${HEXOS_CODING_PROJECT_USER}:${HEXOS_CODING_PROJECT_TOKEN}@${HEXOS_CODING_REF}" master:${HEXOS_CODING_BRANCH} 
  #-------------END: Push to remote repository -------------#
```



#### Github Actions

You need to configure the following environment variables in the `.github/workflows/GitHubActions.yml` file:

* `TZ`:  Time zone.  See  [Timezones](https://www.php.net/manual/en/timezones.php)。**Required**。
* `HEXOS_U_NAME`:  Committer.
* `HEXOS_U_EMAIL`:  Committer’s mail.
* `HEXOS_GITHUB_REF`:  Repository url，[Github](https://github.com/)。no with `https`。
* `HEXOS_GITHUB_BRANCH`:  Remote branch，[Github](https://github.com/)。
* `HEXOS_GITEE_REF`:  Repository url，[Gitee](https://gitee.com/)。no with `https`。
* `HEXOS_GITEE_BRANCH`: Remote branch，[Gitee](https://gitee.com/)。
* `HEXOS_CODING_REF`:  Repository url，[Coding](https://coding.net/)。no with `https`。
* `HEXOS_CODING_BRANCH`: Remote branch，[Coding](https://coding.net/)。

> **Note**: it is recommended to configure these environment variables in GitHub's repository.



Configure these environment variables in GitHub's Repository:

* `HEXOS_GITHUB_TOKEN`:  Github  token。
* `HEXOS_GITEE_USER`:  Gitee user。
  * Personal space address suffix, such as `XXX` in `https://gitee.com/XXX`.
* `HEXOS_GITEE_TOKEN`:  Gitee  token。
* `HEXOS_CODING_PROJECT_USER`:  Coding  project user。
* `HEXOS_CODING_PROJECT_TOKEN`:  Coding  project token。



By default, only the GitHub platform is enabled. To push to other code hosting platforms,  you need to modify in `.github/workflows/GitHubActions.yml`   and remove the previous `#`.

```yaml
      # Push the compiled file to the specified repository
    - name: Deploy Hexos to GITHUB
      continue-on-error: true
      run: |  
        cd ./public
        git push --force --quiet "https://${{ secrets.HEXOS_GITHUB_TOKEN }}@${HEXOS_GITHUB_REF}" master:${HEXOS_GITHUB_BRANCH}
    - name: Deploy Hexos to CODING
      continue-on-error: true
      run: |  
        cd ./public
        git push --force --quiet "https://${{ secrets.HEXOS_CODING_PROJECT_USER }}:${{ secrets.HEXOS_CODING_PROJECT_TOKEN }}@${HEXOS_CODING_REF}" master:${HEXOS_CODING_BRANCH}  
    - name: Deploy Hexos to GITEE
      continue-on-error: true
      run: |  
#         rm -rf public/.git
#         rm -f public/.gitattributes
#         git init public/
#         git config -f public/.git/config  user.name "${HEXOS_U_NAME}"
#         git config -f public/.git/config  user.email "${HEXOS_U_EMAIL}"
#         git config -f public/.git/config  http.postBuffer  524288000
#         ( cd ./public && git add . && git commit -m "GitHub Actions auto build at `date +"%Y-%m-%d %H:%M"`" )
        cd ./public
        git push --force --quiet "https://${{ secrets.HEXOS_GITEE_USER }}:${{ secrets.HEXOS_GITEE_TOKEN }}@${HEXOS_GITEE_REF}" master:${HEXOS_GITEE_BRANCH}
```

The LFS support of gitee platform is limited to enterprise version only. If the enterprise version is not purchased, the above annotated code can be enabled.



## Run

> See：[hexo-commands](https://hexo.io/zh-cn/docs/commands)

### Clean cache 

```shell
hexo clean
```

Clear cache file (`db.json`)  And generated static files (`public`).

### Generating static files 

```shell
hexo generate
```

### Local Preview

```shell
hexo server
```

Start the local server. By default, the web address is： `http://localhost:4000/`。 



### Command combination

```shell
hexo clean &&  hexo generate &&  hexo server
```



## Syntax

See  `doc/User/Use.en.md`



## Get token

### Github 

> See：  [Creating a personal access token](https://docs.github.com/en/free-pro-team@latest/github/authenticating-to-github/creating-a-personal-access-token) 

1. [Verify your email address](https://docs.github.com/en/articles/verifying-your-email-address), if it hasn't been verified yet. 

2. In the upper-right corner of any page, click your profile photo, then click **Settings**.

   ![用户栏中的设置图标](https://docs.github.com/assets/images/help/settings/userbar-account-settings.png)

   

3. In the left sidebar, click **Developer settings**.

   ![开发人员设定](https://docs.github.com/assets/images/help/settings/developer-settings.png)

   

4. In the left sidebar, click **Personal access tokens**.

   ![个人访问令牌](https://docs.github.com/assets/images/help/settings/personal_access_tokens_tab.png)

   

5. Click **Generate new token.**

   ![生成新令牌按钮](https://docs.github.com/assets/images/help/settings/generate_new_token.png)

   

6. Give your token a descriptive name.

   ![令牌描述字段](https://docs.github.com/assets/images/help/settings/token_description.png)

   

7. Select the scopes, or permissions, you'd like to grant this token. To use your token to access repositories from the command line, select **repo**.

   ![选择令牌范围](https://docs.github.com/assets/images/help/settings/token_scopes.gif)

   

8. Click **Generate token**.

   ![生成令牌按钮](https://docs.github.com/assets/images/help/settings/generate_token.png)

   

9. Click  to copy the token to your clipboard. For security reasons, after you navigate off the page, you will not be able to see the token again.

   ![新创建的令牌](https://docs.github.com/assets/images/help/settings/personal_access_tokens.png)

   

   > **Warning**: Treat your tokens like passwords and keep them secret. When working with the API, use tokens as environment variables instead of hardcoding them into your programs.



### Gitee 

> See：  [Creating a personal access token](https://gitee.com/profile/personal_access_tokens) 


1. Log in to your account at [Gitee](https://gitee.com)。
2. In the upper right corner of any page, click on your profile avatar, and then click **settings**.
3. In the left sidebar, click **private token**.
4. Click **generate a new token**.
5. Give your token a descriptive name.
6. Select the scope or permissions you want to grant this token.
7. Click **submit** to generate the token. Sensitive operation, need password.
8. Click the icon to copy the token to the clipboard. For security reasons, you will not be able to see the token again after you leave the page.


   > **Warning**: Treat your tokens like passwords and keep them secret. When working with the API, use tokens as environment variables instead of hardcoding them into your programs.



### Coding

> See：
>
> [Personal access token](https://help.coding.net/docs/member/tokens.html)  
>
> [Project access token](https://help.coding.net/docs/project-settings/features/deploy-tokens.html)

#### Creating  personal access token
1. click on your profile avatar, and then click **profile settings**.

   ![img](https://help-assets.codehub.cn/enterprise/20191230164301.png) 


2. Select the access token on the left side to enter the personal access token list and click the new token.
   ![img](https://help-assets.codehub.cn/enterprise/20191230163637.png) 


3. Fill in the token description in the form and select the access permission for this token. Fill in and submit.
   ![img](https://help-assets.codehub.cn/enterprise/20190924204359.png) 


After submitting, the page will jump back to the access token list page and display the contents of the new token.

> **Note**: the content of the token will only be displayed once. For security, please copy and paste it to the place you need to use, and do not save the copy. If you need to debug, after debugging, choose to regenerate the token, and then paste it into the script of the end-user program or.



#### Creating  project access token

1. Click 【Project settings】->【Developer options】->【Project token】->【 New project token】 in the project.

![img](https://help-assets.codehub.cn/enterprise/20191230150105.png)

2. After entering the token name, selecting the expiration time and checking the token permission, the creation can be completed.

![img](https://help-assets.codehub.cn/enterprise/20191230150155.png)



